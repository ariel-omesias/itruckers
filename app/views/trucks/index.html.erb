<p id="notice"><%= notice %></p>

<h1>Trucks</h1>

<div class="w-100 mt-2">
  <%= form_tag(root_path, method: :get) do %>
    <div class="form-group">
      <%= submit_tag("buscar", :class => "ml-2 btn-primary text-white float-right") %>
      <%= text_field_tag(:search, params[:search], :class => "w-50 float-right form-control d-inline") %>
    </div>
  <% end %>
</div>

<table class="table table-borderless">
  <thead>
    <tr>
      <th>Image</th>
      <th class="descriptionTruck">Description</th>
      <th>Type</th>
      <th>Tonnage</th>
      <th>Region</th>
      <th>Commune</th>
      <th>Rate</th>
      <% if current_user %>      
        <th>User</th>
        <th>Score</th>
      <% end %>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @trucks.each do |truck| %>
      <tr>
        <td><%= image_tag truck.picture.variant(resize: "100x100") %></td>
        <td><%= truck.description %></td>
        <td><%= truck.type_truck.name %></td>
        <td><%= truck.tonnage %></td>
        <td><%= truck.region %></td>
        <td><%= truck.commune %></td>
        <td><%= truck.rate %></td>    

        <% if user_signed_in? %>    
          <td><%= truck.user.name %></td>
          <td>
          <span class="parent-likes">
              <span class = "like_count" <%= truck.id %> >
                <%= truck.get_likes.size %> &#128591 
              </span>
                <a>
                  <% if current_user.liked? truck %>
                      <div> <%= link_to like_truck_path(truck, 'unlike'), class: "preached-btn", method: :put, remote: :true do %> Preached </div>
                    <% end %>
                    <% else %>
                        <div> <%= link_to like_truck_path(truck, 'like'), class:"preach-btn", method: :put, remote: :true do %> Preach </div>
                    <% end %>
                  <% end %>
                <a>
            </span>

        <% end %>

          <% if user_signed_in? && truck.user.id == current_user.id %>
          </td>
          <td><%= link_to 'Show', truck %></td>
          <td><%= link_to 'Edit', edit_truck_path(truck) %></td>
          <td><%= link_to 'Destroy', truck, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<% if user_signed_in?  %>
  <%= link_to 'New Truck', new_truck_path %>
<% end %>


